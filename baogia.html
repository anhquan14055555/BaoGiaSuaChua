<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o Gi√° S·ª≠a Ch·ªØa Nh√† T∆∞∆°ng T√°c</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: The application is designed as a single-page interactive dashboard. This structure was chosen over a static table for enhanced usability and clarity. It starts with a high-level summary (total cost, item count) for a quick overview. The core of the app is a card-based layout for detailed repair items, which is more responsive and intuitive than a wide table. Each card allows for interactive input of quantity and price, with real-time updates to totals. A dynamic donut chart provides an immediate visual breakdown of cost distribution. This flow (Summary -> Details -> Visual Analysis) guides the user logically through the information, making it easier to understand and evaluate the quote. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Overall cost and item count. -> Goal: Inform. -> Viz/Method: Large-number "Stat Cards" (HTML/Tailwind). -> Interaction: Real-time updates via JS. -> Justification: Provides immediate, high-level context.
        - Report Info: Individual repair items (location, description, solution, cost). -> Goal: Organize, Inform, Compare. -> Viz/Method: Interactive cards (HTML/Tailwind with JS-driven inputs). -> Interaction: User can input quantity/price, triggering calculations. -> Justification: A modular, responsive, and interactive way to present detailed information.
        - Report Info: Cost breakdown by item. -> Goal: Compare, Analyze. -> Viz/Method: Dynamic Donut Chart (Chart.js/Canvas). -> Interaction: Chart updates automatically as prices are entered. -> Justification: Visually communicates cost proportions far more effectively than a list of numbers.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #f8f7f4;
            color: #4a4a4a;
        }
        .main-title {
            color: #a38560;
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            transition: box-shadow 0.3s ease-in-out, transform 0.3s ease-in-out;
        }
        .card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-5px);
        }
        .input-field {
            border: 1px solid #d1c9c0;
            background-color: #fdfcfb;
            color: #6b7280;
            transition: border-color 0.2s;
        }
        .input-field:focus {
            outline: none;
            border-color: #a38560;
            box-shadow: 0 0 0 2px rgba(163, 133, 96, 0.2);
        }
        .btn-print {
            background-color: #a38560;
            color: #ffffff;
            transition: background-color 0.3s;
        }
        .btn-print:hover {
            background-color: #8a6f4f;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 450px;
            height: auto;
            min-height: 400px;
            margin: auto;
        }
        @media print {
            .no-print {
                display: none;
            }
            body {
                background-color: #ffffff;
            }
            .card {
                box-shadow: none;
                border: 1px solid #ccc;
                page-break-inside: avoid;
            }
            .print-grid {
                 display: block;
            }
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold main-title">B√ÅO GI√Å S·ª¨A CH·ªÆA & CH·ªêNG TH·∫§M</h1>
            <p class="text-gray-500 mt-2">Phi√™n b·∫£n t∆∞∆°ng t√°c, c·∫≠p nh·∫≠t ng√†y: <span id="current-date"></span></p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10 text-center">
            <div class="card p-5 rounded-xl">
                <h3 class="text-lg font-semibold text-gray-500">T·ªïng chi ph√≠ (VND)</h3>
                <p id="total-cost" class="text-3xl font-bold main-title mt-2">0</p>
            </div>
            <div class="card p-5 rounded-xl">
                <h3 class="text-lg font-semibold text-gray-500">S·ªë h·∫°ng m·ª•c</h3>
                <p id="item-count" class="text-3xl font-bold main-title mt-2">0</p>
            </div>
             <div class="card p-5 rounded-xl">
                <h3 class="text-lg font-semibold text-gray-500">Tr·∫°ng th√°i</h3>
                <p class="text-3xl font-bold text-yellow-500 mt-2">Ch·ªù duy·ªát</p>
            </div>
        </div>
        
        <div class="mb-10 p-6 card rounded-xl">
             <h2 class="text-2xl font-bold text-center mb-6 main-title">Ph√¢n t√≠ch chi ph√≠</h2>
             <p class="text-center text-gray-500 mb-4">Bi·ªÉu ƒë·ªì d∆∞·ªõi ƒë√¢y th·ªÉ hi·ªán t·ª∑ tr·ªçng chi ph√≠ c·ªßa t·ª´ng h·∫°ng m·ª•c trong t·ªïng d·ª± to√°n. ƒêi·ªÅu n√†y gi√∫p b·∫°n d·ªÖ d√†ng nh·∫≠n bi·∫øt h·∫°ng m·ª•c n√†o chi·∫øm chi ph√≠ cao nh·∫•t.</p>
             <div class="chart-container">
                <canvas id="cost-chart"></canvas>
            </div>
        </div>

        <div>
            <h2 class="text-2xl font-bold text-center mb-6 main-title">Chi ti·∫øt c√°c h·∫°ng m·ª•c</h2>
            <div id="item-list" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            </div>
        </div>
        
        <footer class="text-center mt-12 no-print">
            <button onclick="window.print()" class="btn-print font-bold py-3 px-8 rounded-lg shadow-lg">
                üñ®Ô∏è In ho·∫∑c L∆∞u PDF
            </button>
        </footer>

    </div>

    <script>
        const repairItemsData = [
            {
                id: 1,
                location: "Ph√≤ng ng·ªß 1 (C·ª≠a k√≠nh l·ªõn)",
                description: "N∆∞·ªõc m∆∞a th·∫•m m·∫°nh v√†o ph√≤ng qua khe v√† khu√¥n c·ª≠a k√≠nh. 2 vi√™n g·∫°ch l√°t n·ªÅn trong ph√≤ng b·ªã ph·ªìng r·ªôp, b·∫≠p b√™nh do ng·∫•m n∆∞·ªõc.",
                solution: "Th√°o d·ª° ph·∫ßn n·∫πp, b∆°m keo ch·ªëng th·∫•m chuy√™n d·ª•ng cho khung c·ª≠a v√† t∆∞·ªùng. ƒê·ª•c v√† thay th·∫ø 2 vi√™n g·∫°ch b·ªã h·ªèng, tr√°t l·∫°i n·ªÅn.",
                unit: "G√≥i",
            },
            {
                id: 2,
                location: "Ph√≤ng ng·ªß 2 (C·ª≠a s·ªï)",
                description: "T∆∞·ªùng khu v·ª±c c·ª≠a s·ªï b·ªã ng·∫•m n∆∞·ªõc, ·∫©m m·ªëc loang l·ªï. B·ª©c t∆∞·ªùng ƒë·ªëi di·ªán c·ª≠a s·ªï c√≥ v·∫øt n·ª©t ch√¢n chim.",
                solution: "X·ª≠ l√Ω ch·ªëng th·∫•m to√†n b·ªô khu√¥n c·ª≠a s·ªï v√† khu v·ª±c t∆∞·ªùng xung quanh. X·ª≠ l√Ω v·∫øt n·ª©t t∆∞·ªùng, b·∫£ v√† s∆°n l·∫°i.",
                unit: "G√≥i",
            },
            {
                id: 3,
                location: "Ph√≤ng m√°y gi·∫∑t",
                description: "T∆∞·ªùng b·ªã th·∫•m n∆∞·ªõc t·ª´ b√™n ngo√†i v√†o, g√¢y ·∫©m m·ªëc. Quan s√°t b√™n ngo√†i th·∫•y c√≥ v·∫øt n·ª©t t∆∞·ªùng.",
                solution: "X·ª≠ l√Ω v·∫øt n·ª©t v√† ch·ªëng th·∫•m cho m·∫£ng t∆∞·ªùng b√™n ngo√†i. C·∫°o l·ªõp s∆°n c≈©, x·ª≠ l√Ω ch·ªëng th·∫•m v√† s∆°n l·∫°i t∆∞·ªùng b√™n trong.",
                unit: "G√≥i",
            },
            {
                id: 4,
                location: "S√¢n ph∆°i / Ban c√¥ng",
                description: "N·ªÅn s√¢n b·ªã n·ª©t g√£y, n∆∞·ªõc m∆∞a th·∫•m xu·ªëng khu v·ª±c xung quanh v√† c√≥ th·ªÉ ·∫£nh h∆∞·ªüng t·∫ßng d∆∞·ªõi.",
                solution: "ƒê·ª•c b·ªè to√†n b·ªô l·ªõp g·∫°ch v√† v·ªØa n·ªÅn c≈©. V·ªá sinh v√† thi c√¥ng ch·ªëng th·∫•m 2-3 l·ªõp b·∫±ng v·∫≠t li·ªáu chuy√™n d·ª•ng. L√°t l·∫°i g·∫°ch m·ªõi v√† ch√† ron ch·ªëng th·∫•m.",
                unit: "m¬≤",
            }
        ];

        let costChart;

        document.addEventListener('DOMContentLoaded', () => {
            renderItems();
            updateTotals();
            createChart();
            document.getElementById('current-date').textContent = new Date().toLocaleDateString('vi-VN');
        });

        function formatCurrency(value) {
            return new Intl.NumberFormat('vi-VN').format(value);
        }

        function renderItems() {
            const itemList = document.getElementById('item-list');
            itemList.innerHTML = '';
            repairItemsData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'card rounded-xl p-6 flex flex-col';
                itemEl.innerHTML = `
                    <h3 class="text-xl font-bold mb-3 main-title">${item.id}. ${item.location}</h3>
                    <div class="text-gray-600 mb-4 flex-grow">
                        <p class="font-semibold">Hi·ªán tr·∫°ng:</p>
                        <p>${item.description}</p>
                    </div>
                    <div class="text-gray-700 mb-5 flex-grow">
                        <p class="font-semibold">Gi·∫£i ph√°p ƒë·ªÅ xu·∫•t:</p>
                        <p>${item.solution}</p>
                    </div>
                    <div class="mt-auto bg-stone-50 p-4 rounded-lg">
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 items-center">
                            <div>
                                <label for="quantity-${item.id}" class="block text-sm font-medium text-gray-500">S·ªë l∆∞·ª£ng</label>
                                <input type="number" id="quantity-${item.id}" oninput="updateCost(${item.id})" class="mt-1 input-field block w-full rounded-md shadow-sm p-2" placeholder="0" min="0">
                            </div>
                             <div>
                                <label for="price-${item.id}" class="block text-sm font-medium text-gray-500">ƒê∆°n gi√° (${item.unit})</label>
                                <input type="number" id="price-${item.id}" oninput="updateCost(${item.id})" class="mt-1 input-field block w-full rounded-md shadow-sm p-2" placeholder="0" min="0">
                            </div>
                            <div class="text-center sm:text-right">
                                <label class="block text-sm font-medium text-gray-500">Th√†nh ti·ªÅn</label>
                                <p id="total-${item.id}" class="text-lg font-bold text-green-600 mt-1">0</p>
                            </div>
                        </div>
                    </div>
                `;
                itemList.appendChild(itemEl);
            });
        }
        
        function updateCost(itemId) {
            const quantity = document.getElementById(`quantity-${itemId}`).value || 0;
            const price = document.getElementById(`price-${itemId}`).value || 0;
            const total = quantity * price;
            
            document.getElementById(`total-${itemId}`).textContent = formatCurrency(total);
            updateTotals();
        }

        function updateTotals() {
            let totalCost = 0;
            repairItemsData.forEach(item => {
                const quantity = document.getElementById(`quantity-${item.id}`)?.value || 0;
                const price = document.getElementById(`price-${item.id}`)?.value || 0;
                totalCost += quantity * price;
            });

            document.getElementById('total-cost').textContent = formatCurrency(totalCost);
            document.getElementById('item-count').textContent = repairItemsData.length;
            
            updateChart();
        }

        function createChart() {
            const ctx = document.getElementById('cost-chart').getContext('2d');
            const initialData = {
                labels: repairItemsData.map(item => item.location),
                datasets: [{
                    data: repairItemsData.map(() => 1), 
                    backgroundColor: [
                        '#a38560', '#c9b7a1', '#e3d5c4', '#6b5b4a',
                        '#8a6f4f', '#a89a8a'
                    ],
                    borderColor: '#f8f7f4',
                    borderWidth: 4,
                    hoverOffset: 8
                }]
            };

            costChart = new Chart(ctx, {
                type: 'doughnut',
                data: initialData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14,
                                    family: "'Be Vietnam Pro', sans-serif"
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.parsed || 0;
                                    const total = context.chart.getData().datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(2) : 0;
                                    return `${label}: ${formatCurrency(value)} VND (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        function updateChart() {
            if (!costChart) return;
            
            const costs = repairItemsData.map(item => {
                const quantity = document.getElementById(`quantity-${item.id}`)?.value || 0;
                const price = document.getElementById(`price-${item.id}`)?.value || 0;
                return quantity * price;
            });
            
            const hasData = costs.some(cost => cost > 0);
            
            if(hasData) {
                costChart.data.datasets[0].data = costs;
            } else {
                costChart.data.datasets[0].data = repairItemsData.map(() => 1);
            }

            costChart.update();
        }
    </script>

</body>
</html>
